<!DOCTYPE html>
<html>
	<head>
	<title>Chat21</title>
	<style>
	body{margin:0;}
	#content{
	margin:0;
	}
	#messages-div{
	height:90%;
	margin:0;
	padding:0px;
	display:block;
	list-style-type:none;
	
	}
	#messages{
	font-family:Arial,sans;
	list-style-type:none;
	}
	#input{
	margin:0;
	padding:0px;
	display:block;
	position:fixed;
	bottom:0px;
	width:100%;
	}
	#m{
	width:99.9%;
	height:auto;
	display:block;
	}
	#form{height:100%;width:100%;}
	</style>
	</head>
	<body>
	<div id = 'content'>
		<div id = 'messages-div'>
			<ul id = 'messages'></ul>
		</div>
		<div id = 'input'>
			<form action='' id = 'form'>
			<input id = 'm'>
			</input>
			</form>
		</div>
	<br>
	</div>			
	</body>
	<script src="https://cdn.socket.io/socket.io-1.2.0.js"></script>
	<script src="http://code.jquery.com/jquery-1.11.1.js"></script>
	<script>
	var socket = io();
	var name;
	name = prompt('Username: ', '');
	socket.on('connection', function(){
		scrollToBottom();
	});
	$('form').submit(function(){
		var msg = $('#m').val();		
		$('#m').val('');
		if(msg.charAt(0) == '/') {
			processCommand(msg);
			return false;
		};
		if(msg == '') return false;
		socket.emit('chat message', name + ' : ' + msg);
		return false;
	});
	socket.on('chat message', function(msg){
		$('#messages').append($('<li>').text(msg));
		scrollToBottom();
	});
	function processCommand(command){
		if(command == '/clear'){
			$('#messages').text('');
		}
		if(command == '/help'){
			$('#messages').append($('<li>').text('/help = Show help menu, /clear = Clear screen'));
		}
		scrollToBottom();
	}
	function scrollToBottom(){
		window.scrollTo(0,document.body.scrollHeight);
	}
	</script>
</html>
